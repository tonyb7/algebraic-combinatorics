% Wednesday 2.21
\subsection{Applications of Lagrange's Theorem}
\begin{theorem}[Cayley's Formula]
There are $n^{n-2}$ trees and $n^{n-1}$ rooted trees on the vector set $[n]$.
We can use Lagrange theorem to prove.
\end{theorem}

\begin{proposition}
Let $a_n$ denote the number of rooted trees on $[n]$, 
$$A(x)=\sum\limits_{n\geq 1} \dfrac{a_n}{n!}x^n \in \mathbb{C}[[x]] (\text{exponential generating function}),$$
then $A(x)=xe^{A(x)}$.
\end{proposition}
\begin{proof}
For $n\geq 1,$ we have $[x^n]xe^{A(x)}=[x^{n-1}]\sum\limits_{m\geq 0}\dfrac{A^m}{m!}.$
\begin{align*}
n=1  &\Rightarrow \dfrac{a_1}{1!}\\
n\geq 2 &\Rightarrow \text{RHS}=\sum\limits_{m=1}^{n-1}\dfrac{1}{m!}\sum\limits_{i_1..i_m\geq 1, i_1+..+i_m=n-1} \dfrac{a_{i_1}}{i_1!} ...\dfrac{a_{i_m}}{i_m!}
\end{align*}
We need to show that this equals $\dfrac{a_n}{n!}$, i.e.,$$a_n=\sum\limits_1^{n-1}\dfrac{n}{m!}\sum\limits_{i_1..i_m\geq 1, i_1+..+i_m=n-1}{\binom{n-1}{i_1,\cdots,i_m}}a_{i_1}...a_{i_m}(*)$$

Interpretation:
\begin{itemize}
\item $n$ = \# vertices
\item $m$ = \# neighbors of $r$
\item $m!$ =\# ways to order the smaller rooted trees
\item $i_1...i_m$ = \# vertices of smaller trees
\item $\binom{n-1}{i_1,\cdots,i_m}$ = \# ways  to choose the vertex sets of the smaller rooted trees
\end{itemize}

So we have $A(x)=x\phi(x)$, where $\phi(x)=e^x$. By Lagrange's theorem $n\neq 0$,
\begin{align*}
[x^n]A(x)&=\dfrac{1}{n}[x^{n-1}]\phi(x)^n\\
\dfrac{a_n}{n!}&=\dfrac{1}{n}[x^{n-1}]e^{nx} =\dfrac{1}{n}\dfrac{n^{n-1}}{(n-1)!}
\end{align*}
So $a_n=n^{n-1}.$
\end{proof}

\begin{theorem}[Abel's binomial theorem]
For $r\in \mathbb{C}$, we have (for $n\geq 1$)
\begin{align*}
[x^n]e^{rA(x)} &= \dfrac{1}{n}[x^{n-1}](e^{rx})'(e^x)^n\\
&=\dfrac{r}{n}[x^{n-1}]e^{rx}e^{nx}\\
&=\dfrac{r}{n}\dfrac{(r+n)^{n-1}}{(n-1)!}=\dfrac{r(r+n)^{n-1}}{n!}\\
[x^0]e^{rA(x)}&=1
\end{align*}
So $$e^{rA(x)}=\sum_{n\geq 0}\dfrac{r(r+n)^{n-1}}{n!}x^n.$$

Taking $[x^n]$ in the identity,
$e^{(\alpha +\beta)A(x)}=e^{\alpha A(x)}e^{\beta A(x)}(\alpha , \beta \in \mathbb{C}).$

We obtain
$$\dfrac{(\alpha+\beta)(\alpha+\beta+n)^{n-1}}{n!}=\sum\limits_{i,j\geq 0, i+j=n} \dfrac{\alpha(\alpha+i)^{i-1}}{i!}\dfrac{\beta(\beta+n-i)^{i-1}}{i!}$$
$$\Rightarrow (\alpha+\beta)(\alpha+\beta+n)^{n-1}=\sum\limits_{i=1}^n{\binom{n}{i}} \alpha (\alpha+i)^{i-1} \beta (\beta+n-i)^{n-i-1}.$$

\end{theorem}

